(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"2d95":function(e,t,l){},c50e:function(e,t,l){"use strict";l("2d95")},d1d7:function(e,t,l){"use strict";l.r(t);var o=l("ded3"),a=l.n(o),i=l("7a23");const u=Object(i["W"])("data-v-61e61d36");Object(i["F"])("data-v-61e61d36");const d={class:"tw-flex tw-items-center tw-justify-end"},c={class:"tw-text-lg tw-text-right tw-mr-3"},n={class:"tw-p-5",style:{"max-width":"300px","min-height":"220px","max-height":"500px"}},s={class:"row tw-w-full"},r={class:"col tw-flex tw-justify-between tw-items-center"},v={class:"tw-text-sm tw-text-gray-400"},b={class:"tw-flex tw-justify-end tw-mt-2"},f={class:"tw-mr-3"},j={class:"tw-text-lg"},O={class:"tw-flex"},h={id:"scrollBottom",class:"tw-overflow-x-scroll tw-w-full",style:{"margin-left":"150px"}},w={class:"tw-flex"},m={style:{"line-height":"0px",width:"150px"}},p=Object(i["l"])("div",{class:"cell-guide first-row tw-w-full tw-flex tw-justify-center tw-items-center tw-truncate tw-bg-gray-100"},"Guides",-1),y=Object(i["l"])("div",{class:"cell-guide first-row tw-w-full tw-flex tw-justify-center tw-items-center tw-truncate tw-border-t-2 tw-bg-gray-100"},"Guides",-1),g={id:"scrollTop",class:"tw-overflow-x-scroll tw-relative"},x={id:"tours-container",style:{"line-height":"0px",position:"relative"}};Object(i["D"])();const D=u(((e,t,l,o,D,T)=>{const S=Object(i["K"])("q-badge"),C=Object(i["K"])("q-btn"),M=Object(i["K"])("q-section"),Y=Object(i["K"])("q-item-label"),G=Object(i["K"])("q-item-section"),k=Object(i["K"])("q-item"),W=Object(i["K"])("BaseSelect"),I=Object(i["K"])("BaseButton"),H=Object(i["K"])("q-menu"),V=Object(i["K"])("q-space"),q=Object(i["K"])("q-date"),A=Object(i["K"])("q-popup-proxy"),K=Object(i["K"])("q-icon"),_=Object(i["K"])("BaseInput"),B=Object(i["K"])("SheduleGuideShowTour"),L=Object(i["K"])("q-page");return Object(i["U"])((Object(i["C"])(),Object(i["h"])(L,{padding:""},{default:u((()=>[Object(i["l"])("div",d,[Object(i["l"])("div",c,[e.toursWithoutGuide.length?(Object(i["C"])(),Object(i["h"])(C,{key:0,color:"primary",label:"Assign Tour"},{default:u((()=>[Object(i["l"])(S,{color:"orange",floating:""},{default:u((()=>[Object(i["k"])(Object(i["O"])(e.toursWithoutGuide.length),1)])),_:1})])),_:1})):Object(i["i"])("",!0),Object(i["l"])(H,{anchor:"bottom left",self:"bottom right",modelValue:e.menuAssignTour,"onUpdate:modelValue":t[3]||(t[3]=t=>e.menuAssignTour=t)},{default:u((()=>[Object(i["l"])("div",n,[Object(i["l"])(W,{options:e.toursWithoutGuide,label:"Tours",modelValue:e.tourToAssign,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tourToAssign=t)},{"selected-item":u((e=>[Object(i["l"])("div",s,[Object(i["l"])("div",{class:"col",style:{maxWidth:"30px",height:"30px",backgroundColor:e.opt.color}},null,4),Object(i["l"])("div",r,[Object(i["l"])("label",{class:"tw-ml-3",innerHTML:e.opt.name},null,8,["innerHTML"]),Object(i["l"])("label",v,Object(i["O"])(e.opt.type),1)])])])),option:u((e=>[Object(i["l"])(k,Object(i["s"])(e.itemProps,{class:"tw-flex tw-items-center"}),{default:u((()=>[Object(i["l"])(M,{avatar:""},{default:u((()=>[Object(i["l"])("div",{style:{width:"30px",height:"30px",backgroundColor:e.opt.color}},null,4)])),_:2},1024),Object(i["l"])(G,{class:"tw-ml-3"},{default:u((()=>[Object(i["l"])(Y,{innerHTML:e.opt.name},null,8,["innerHTML"]),Object(i["l"])(Y,{caption:""},{default:u((()=>[Object(i["k"])(Object(i["O"])(e.opt.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","modelValue"]),Object(i["l"])(W,{disable:e.tourToAssign,class:"tw-mt-3",modelValue:e.guideToAssign,"onUpdate:modelValue":t[2]||(t[2]=t=>e.guideToAssign=t),options:e.guidesSelect,label:"Guide","option-label":"name","option-value":"id","use-input":""},null,8,["disable","modelValue","options"]),Object(i["l"])("div",b,[Object(i["l"])(I,{label:"Assign",type:"submit",color:"primary",class:"q-ml-sm",loading:e.loading,onClick:e.assingGuide},null,8,["loading","onClick"])])])])),_:1},8,["modelValue"])]),Object(i["l"])(V),Object(i["l"])("div",f,[Object(i["l"])(_,{readonly:"",modelValue:e.startDate,"onUpdate:modelValue":t[6]||(t[6]=t=>e.startDate=t),label:"Date"},{append:u((()=>[Object(i["l"])(K,{name:"event",class:"cursor-pointer"},{default:u((()=>[Object(i["l"])(A,{modelValue:e.startDatePopup,"onUpdate:modelValue":t[5]||(t[5]=t=>e.startDatePopup=t),"transition-show":"scale","transition-hide":"scale"},{default:u((()=>[Object(i["l"])(q,{minimal:"",modelValue:e.startDatePicker,"onUpdate:modelValue":t[4]||(t[4]=t=>e.startDatePicker=t),options:e.optionsFn},null,8,["modelValue","options"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])]),Object(i["l"])("div",j,[Object(i["l"])(K,{class:"q-mr-sm",name:"chevron_left",style:{"font-size":"30px",cursor:"pointer"},onClick:t[7]||(t[7]=t=>e.date=e.dayjs(e.date).subtract(e.daysToShow,"day"))}),Object(i["k"])(" "+Object(i["O"])(e.currentInterval)+" ",1),Object(i["l"])(K,{class:"q-mr-sm",name:"chevron_right",style:{"font-size":"30px",cursor:"pointer"},onClick:t[8]||(t[8]=t=>e.date=e.dayjs(e.date).add(e.daysToShow,"day"))})])]),Object(i["l"])("div",O,[Object(i["l"])("div",h,[Object(i["l"])("div",{style:{minWidth:e.daysToShow*e.columnWidth+"px",height:"20px"}},null,4)])]),Object(i["l"])("div",w,[Object(i["l"])("div",m,[p,(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.guides,((t,l)=>(Object(i["C"])(),Object(i["h"])("div",{onClick:t=>e.selectGuide(l),key:t.id,class:["cell-guide tw-w-full tw-flex tw-justify-center tw-items-center tw-truncate tw-font-medium tw-cursor-pointer guide",{"selected-guide":l==e.selectGuideIndex,"tw-bg-gray-200":l%2==0}],textContent:Object(i["O"])(t.name)},null,10,["onClick","textContent"])))),128)),y]),Object(i["l"])("div",g,[Object(i["l"])("div",{class:"tw-flex tw-overflow-y-auto tw-overflow-x-hidden",style:{minWidth:e.daysToShow*e.columnWidth+"px"}},[Object(i["l"])("div",x,[(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.toursWithGuide,((t,l)=>(Object(i["C"])(),Object(i["h"])("div",{key:l,onClick:Object(i["V"])((l=>{e.showTourRefresh=!e.showTourRefresh,e.tourToShow=t}),["stop"]),class:"tw-absolute tw-flex tw-justify-center tw-items-center tw-font-medium tw-rounded-3xl tw-cursor-pointer",style:a()({},e.getStyle(t))},[Object(i["l"])("div",null,Object(i["O"])(t.code)+" | "+Object(i["O"])(t.endDate),1)],12,["onClick"])))),128)),(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.days,((e,t)=>(Object(i["C"])(),Object(i["h"])("div",{key:t,class:"cell first-row tw-inline-block tw-bg-gray-100"},[Object(i["l"])("div",{class:"tw-flex tw-justify-center tw-items-center tw-h-full",textContent:Object(i["O"])(e)},null,8,["textContent"])])))),128)),(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.guides.length,((t,l)=>(Object(i["C"])(),Object(i["h"])("div",{key:t,class:{"tw-bg-gray-200":l%2==0,"selected-guide":l==e.selectGuideIndex}},[(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.daysToShow,(e=>(Object(i["C"])(),Object(i["h"])("div",{key:e,class:"cell tw-inline-block"})))),128))],2)))),128)),(Object(i["C"])(!0),Object(i["h"])(i["a"],null,Object(i["I"])(e.days,((e,t)=>(Object(i["C"])(),Object(i["h"])("div",{key:t,class:"first-row cell tw-inline-block"},[Object(i["l"])("div",{class:"tw-flex tw-justify-center tw-items-center tw-h-full",textContent:Object(i["O"])(e)},null,8,["textContent"])])))),128))])],4)])]),e.tourToShow?(Object(i["C"])(),Object(i["h"])(B,{id:e.tourToShow.id,type:e.tourToShow.service.code,key:e.showTourRefresh,onRefetch:t[9]||(t[9]=t=>e.refetch()),onRefetchtoursWithoutGuide:t[10]||(t[10]=t=>e.refetchtoursWithoutGuide()),onClose:t[11]||(t[11]=t=>e.tourToShow=!1)},null,8,["id","type"])):Object(i["i"])("",!0)])),_:1},512)),[[i["R"],e.guides.length]])}));var T=l("1840"),S=l("c0ce"),C=l("18d6"),M=l("f32a"),Y=l("5a0c"),G=l.n(Y),k=l("1fcf");const W=Object(i["H"])(G()()),I=Object(i["H"])(C["a"].getItem("guide-scheduler-daysToShow")||90),H=Object(i["f"])((()=>({needle:"",from:W.value.format("MM/DD/YYYY"),to:G()(W.value).add(I.value,"day").format("MM/DD/YYYY"),notification:[],notificationComplete:null,template:null}))),V=Object(i["H"])([]),q=Object(i["H"])([]);function A(){const{loading:e,onResult:t,refetch:l}=Object(T["e"])(M["listTourWithGuideSheduleQuery"],(()=>H.value));return t((e=>{V.value=Object(k["i"])(e.data.listScheduleToursWithGuideTours)})),{loading:e,refetch:l,toursWithGuide:V}}function K(){const{loading:e,onResult:t,refetch:l}=Object(T["e"])(M["listTourWithoutGuideSheduleQuery"]);return t((e=>{q.value=Object(k["i"])(e.data.listScheduleToursWithoutGuideTours)})),{loading:e,refetch:l,toursWithoutGuide:q}}function _(){return{date:W,daysToShow:I,search:H,getToursWithGuide:A,getToursWithoutGuide:K}}var B=l("b375"),L=l.n(B),Q=l("d758"),E=l.n(Q),P=l("3f1c"),$=l("d363"),R=l("9530"),z=l.n(R),U=function(e,t,l,o){function a(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,i){function u(e){try{c(o.next(e))}catch(t){i(t)}}function d(e){try{c(o["throw"](e))}catch(t){i(t)}}function c(e){e.done?l(e.value):a(e.value).then(u,d)}c((o=o.apply(e,t||[])).next())}))},F=Object(i["m"])({components:{SheduleGuideShowTour:$["default"]},setup(){G.a.extend(L.a),G.a.extend(E.a);const e=Object(i["H"])(null),t=Object(i["H"])(null),l=Object(i["H"])(!1),o=Object(i["H"])(!1),a=Object(i["H"])(""),u=Object(i["H"])(0),d=60,c=Object(i["H"])([]);let{getGuides:n,guides:s}=Object(S["a"])();s.value.length||n();let{daysToShow:r,getToursWithGuide:v,date:b,getToursWithoutGuide:f}=_();const{loading:j,refetch:O,toursWithGuide:h}=v(),{loading:w,refetch:m,toursWithoutGuide:p}=f(),{mutate:y,onDone:g,loading:x}=Object(T["d"])(z.a`
        mutation updateTour($input: updateTourInput!) {
          updateTour(input: $input) {
            tour {
              id
            }
          }
        }
      `);g((()=>{O(),m(),l.value=!1}));const D=Object(i["H"])(-1);function C(){var t,l,o,a,i,n,r,v,f,j,O,w;let m=document.getElementById("tours-container"),p=[];if(!m)return;if(null===(t=e.value)||void 0===t?void 0:t.startDate){const t=G()(null===(l=e.value)||void 0===l?void 0:l.startDate);let u=t;"ls"==(null===(a=null===(o=e.value)||void 0===o?void 0:o.service)||void 0===a?void 0:a.code)&&e.value.endDate&&(u=G()(null===(i=e.value)||void 0===i?void 0:i.endDate)),p=h.value.filter((e=>{var l;if(e.startDate){const o=G()(e.startDate);let a=o;return"ls"==(null===(l=e.service)||void 0===l?void 0:l.code)&&e.endDate&&(a=G()(e.endDate)),G()(e.startDate).isSameOrBefore(u,"day")&&a.isSameOrAfter(G()(t),"day")}return!1}))}let y=0,g=(null===(n=e.value)||void 0===n?void 0:n.days)*d;if(null===(r=e.value)||void 0===r?void 0:r.startDate){const t=G()(e.value.startDate).format("YYYY-MM-DD"),l=b.value.format("YYYY-MM-DD");if(y=G()(t).diff(l,"day")*d+d,e.value.endDate){const l=G()(e.value.endDate).format("YYYY-MM-DD");g=(G()(l).diff(G()(t),"day")+1)*d}e.value.days&&e.value.days>1&&(g-=d,y+=Math.round(d/2))}else(null===(v=e.value)||void 0===v?void 0:v.days)&&(y=u.value*d+d);document.querySelectorAll(".tour-space").forEach((e=>e.remove()));for(let u=0,d=3;u<s.value.length;u++){if(d+=25,p.find((e=>{var t;return(null===(t=e.guide)||void 0===t?void 0:t.id)==s.value[u].id}))){c.value.push(u);continue}document.getElementsByClassName("guide")[u].style.backgroundColor=(null===(f=e.value)||void 0===f?void 0:f.color)||"green";const t=document.createElement("div");t.style.width=`${g}px`,t.style.height="19px",t.style.backgroundColor=(null===(j=e.value)||void 0===j?void 0:j.color)||"green",t.style.top=`${d}px`,t.style.left=`${y}px`,t.style.fontSize=1==(null===(O=e.value)||void 0===O?void 0:O.days)?"8px":"14px",t.style.zIndex="3",t.style.width=`${g}px`,t.style.opacity=".5",t.style.whiteSpace="nowrap",t.classList.add("tw-absolute","tw-flex","tw-justify-center","tw-items-center","tw-font-medium","tw-rounded-3xl","tw-cursor-pointer","tour-space"),t.innerHTML=(null===(w=e.value)||void 0===w?void 0:w.code)||"",m.appendChild(t)}}return Object(i["S"])([j,w,x],(([e,t,l])=>P["a"].value=e||t||l)),Object(i["S"])(l,(t=>{t||(e.value=null),document.querySelectorAll(".tour-space").forEach((e=>e.remove()))})),Object(i["S"])(a,(()=>{b.value=G()(a.value)})),Object(i["S"])(e,(t=>U(this,void 0,void 0,(function*(){var l,o,a,i,n,s,r,v,f,j;const h=document.getElementsByClassName("guide");for(let e=0;e<h.length;e++)h[e].style.backgroundColor="";if(c.value=[],!t)return;let w=document.getElementById("scrollTop");if(null===w||void 0===w?void 0:w.offsetWidth){const t=Math.round(w.offsetWidth/d);if(u.value=0,"ls"==(null===(o=null===(l=e.value)||void 0===l?void 0:l.service)||void 0===o?void 0:o.code)&&(null===(a=e.value)||void 0===a?void 0:a.endDate)&&(null===(i=e.value)||void 0===i?void 0:i.startDate)?u.value=Math.round((t-G()(null===(n=e.value)||void 0===n?void 0:n.endDate).diff(null===(s=e.value)||void 0===s?void 0:s.startDate,"day"))/2):"htc"==(null===(v=null===(r=e.value)||void 0===r?void 0:r.service)||void 0===v?void 0:v.code)&&(u.value=Math.round(t/2)),null===(f=e.value)||void 0===f?void 0:f.startDate){const t=G()(null===(j=e.value)||void 0===j?void 0:j.startDate).subtract(u.value,"day");b.value.isSame(t,"day")?(yield O(),C()):b.value=t}}})))),Object(i["S"])(h,(()=>{e.value&&C()})),Object(i["z"])((()=>{const e=document.getElementById("scrollBottom"),t=document.getElementById("scrollTop");e&&t&&(e.addEventListener("scroll",(e=>{t.scrollLeft=e.currentTarget.scrollLeft})),t.addEventListener("scroll",(t=>{e.scrollLeft=t.currentTarget.scrollLeft})))})),{menuAssignTour:l,columnWidth:d,startDatePopup:o,startDatePicker:a,tourToAssign:e,guideToAssign:t,tourToShow:Object(i["H"])(null),showTourRefresh:Object(i["H"])(!1),guides:s,selectGuideIndex:D,daysToShow:r,date:b,dayjs:G.a,toursWithGuide:h,toursWithoutGuide:p,refetch:O,refetchtoursWithoutGuide:m,startDate:Object(i["f"])((()=>G()(b.value).format("DD/MM/YYYY"))),guidesSelect:Object(i["f"])((()=>s.value.filter(((e,t)=>!c.value.includes(t))))),days:Object(i["f"])((()=>Array.from({length:r.value},((e,t)=>G()(b.value).add(t,"day").format("DD/MM"))))),next:()=>{r.value=10,b.value=G()(b.value).add(r.value,"day")},selectGuide:e=>{D.value==e?D.value=-1:D.value=e},getStyle:e=>{let t=0,l=25,o=2,a=e.days*d;const i=s.value.find((t=>{var l;return t.id==(null===(l=e.guide)||void 0===l?void 0:l.id)}));if(i&&(l+=25*s.value.indexOf(i)),e.startDate){const l=G()(e.startDate).format("YYYY-MM-DD"),i=b.value.format("YYYY-MM-DD");if(t=G()(l).diff(i,"day")*d+d,e.endDate){const t=G()(e.endDate).format("YYYY-MM-DD");a=(G()(t).diff(G()(l),"day")+1)*d}e.days&&e.days>1&&(a-=d,t+=Math.round(d/2),o=1)}return{height:"25px",width:`${a}px`,backgroundColor:e.color,top:`${l}px`,left:`${t}px`,fontSize:1==e.days?"8px":"14px",zIndex:o}},currentInterval:Object(i["f"])((()=>`From ${G()(b.value).format("MMMM DD")} to ${G()(b.value).add(r.value,"day").format("MMMM DD")}`)),assingGuide(){var l,o;y({input:{id:null===(l=e.value)||void 0===l?void 0:l.id,guide:null===(o=t.value)||void 0===o?void 0:o.id}})}}}}),J=(l("c50e"),l("9989")),N=l("9c40"),X=l("58a81"),Z=l("4e73"),ee=l("66e5"),te=l("4074"),le=l("0170"),oe=l("2c91"),ae=l("0016"),ie=l("7cbe"),ue=l("52ee"),de=l("eebe"),ce=l.n(de);F.render=D,F.__scopeId="data-v-61e61d36";t["default"]=F;ce()(F,"components",{QPage:J["a"],QBtn:N["a"],QBadge:X["a"],QMenu:Z["a"],QItem:ee["a"],QItemSection:te["a"],QItemLabel:le["a"],QSpace:oe["a"],QIcon:ae["a"],QPopupProxy:ie["a"],QDate:ue["a"]})}}]);