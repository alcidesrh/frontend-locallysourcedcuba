(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[52],{"95e7":function(t,e,c){"use strict";c.r(e);var a=c("7a23");const o={class:"tw-absolute tw-top-1 tw-right-1"},l={key:0,class:"row tw-w-full tw-mt-5"},i={class:"col-12 tw-flex tw-items-center"},n={key:0,class:"tw-flex tw-justify-end tw-items-center"},s={class:"row"},r={class:"col tw-flex tw-items-center",style:{"max-width":"150px"}},d={class:"col tw-flex tw-items-center"},b={key:0,style:{left:"-8px",top:"-9px",background:"whitesmoke"},class:"tw-text-xs tw-transform tw--rotate-12 tw-font-bold tw-uppercase tw-text-red-700 tw-border tw-border-red-700 tw-absolute"},u={class:"tw-p-0 tw-font-semibold tw-text-white tw-flex tw-items-center"},O={class:"tw-ml-3"},j={class:"tw-ml-5 tw-bg-white tw-tracking-widest",style:{"border-radius":"50px",padding:"0px 10px"}},p=Object(a["l"])("div",{class:"tw-text-sm"},"Show Tour Info",-1),f={class:"tw-text-base tw-font-black"},m={key:0,class:"tw-text-sm"},w=Object(a["k"])(" Start date: "),v={class:"tw-font-semibold"},h={key:1,class:"tw-text-sm"},y=Object(a["k"])(" End date: "),g={class:"tw-font-semibold"},T={key:2,class:"tw-text-sm"},x=Object(a["k"])(" Guide: "),k={class:"tw-font-semibold"},C={key:0,class:"tw-p-10 tw-text-center tw-text-gray-400 tw-font-semibold tw-text-md"},Y=Object(a["l"])("label",null,"No result found",-1);function D(t,e,c,D,M,L){const S=Object(a["K"])("PendingNotificationTour"),q=Object(a["K"])("SearchTour"),Q=Object(a["K"])("q-card"),E=Object(a["K"])("BaseButton"),K=Object(a["K"])("q-icon"),N=Object(a["K"])("q-tooltip"),_=Object(a["K"])("q-chip"),V=Object(a["K"])("q-item-section"),I=Object(a["K"])("q-item"),$=Object(a["K"])("q-separator"),H=Object(a["K"])("q-list"),z=Object(a["K"])("q-page"),U=Object(a["K"])("ShowLsTour");return Object(a["C"])(),Object(a["h"])(a["a"],null,[Object(a["l"])(z,{padding:""},{default:Object(a["T"])((()=>[Object(a["l"])(Q,{flat:"",class:"tw-mt-0 tw-flex tw-items-center tw-p-5"},{default:Object(a["T"])((()=>[Object(a["l"])("div",o,[Object(a["l"])(S,{"edit-route":"EditLsTour"})]),t.loadingService?Object(a["i"])("",!0):(Object(a["C"])(),Object(a["h"])("div",l,[Object(a["l"])("div",i,["ls"==t.service.code?(Object(a["C"])(),Object(a["h"])(q,{key:0})):Object(a["i"])("",!0)])]))])),_:1}),t.service.daysToShow?(Object(a["C"])(),Object(a["h"])("div",n,[Object(a["l"])("div",{class:"tw-font-semibold tw-text-gray-700",innerHTML:t.showing},null,8,["innerHTML"]),Object(a["l"])(E,{label:"Create Tour",icon:"add",type:"button",color:"primary",class:"q-ml-sm tw-ml-5",onClick:e[1]||(e[1]=e=>t.$router.push({name:"CreateLsTour"}))})])):Object(a["i"])("",!0),Object(a["l"])(H,{class:"tw-mt-5"},{default:Object(a["T"])((()=>[(Object(a["C"])(!0),Object(a["h"])(a["a"],null,Object(a["I"])(Object.keys(t.tours),((e,c)=>(Object(a["C"])(),Object(a["h"])("div",{key:c},[Object(a["l"])(I,null,{default:Object(a["T"])((()=>[Object(a["l"])(V,null,{default:Object(a["T"])((()=>[Object(a["l"])("div",s,[Object(a["l"])("div",r,[Object(a["l"])("div",{class:"tw-text-gray-500 tw-font-semibold tw-text-center",innerHTML:t.dateColumn(e)},null,8,["innerHTML"])]),Object(a["l"])("div",d,[Object(a["l"])("div",null,[(Object(a["C"])(!0),Object(a["h"])(a["a"],null,Object(a["I"])(t.tours[e],(e=>(Object(a["C"])(),Object(a["h"])("span",{key:e.id},[Object(a["l"])(_,{class:"tw-mr-2 tw-py-3 tw-my-2",style:{backgroundColor:e.color}},{default:Object(a["T"])((()=>[e.canceled?(Object(a["C"])(),Object(a["h"])("div",b,"Canceled")):Object(a["i"])("",!0),Object(a["l"])("div",u,[Object(a["l"])("label",{onClick:Object(a["V"])((c=>{t.refreshView=!t.refreshView,t.id=e.id}),["stop"]),class:"tw-bg-gray-700 tw-tracking-widest tw-cursor-pointer",style:{"border-radius":"50px",padding:"0px 10px"}},Object(a["O"])(e.code),9,["onClick"]),Object(a["l"])("span",O,[(Object(a["C"])(!0),Object(a["h"])(a["a"],null,Object(a["I"])(e.notifications,((e,c)=>(Object(a["C"])(),Object(a["h"])(K,{onClick:Object(a["V"])((c=>t.updateNotification(e)),["stop"]),style:{"border-radius":"50px","font-size":"15px"},class:["tw-mx-1 tw-bg-gray-100 tw-p-1 tw-cursor-pointer",{"tw-text-gray-500":!e.complete,"text-teal":e.complete}],key:c,name:e.icon},null,8,["onClick","class","name"])))),128))]),Object(a["l"])("span",j,[Object(a["l"])(K,{onClick:Object(a["V"])((c=>{t.refreshView=!t.refreshView,t.id=e.id}),["stop"]),class:"q-mr-sm",name:"visibility",color:"blue",style:{"font-size":"20px",cursor:"pointer"}},{default:Object(a["T"])((()=>[Object(a["l"])(N,{class:"bg-indigo",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:Object(a["T"])((()=>[p])),_:1})])),_:2},1032,["onClick"]),Object(a["l"])(K,{onClick:Object(a["V"])((c=>t.edit(e._id)),["stop"]),class:"q-mr-sm",name:"edit",color:"teal",style:{"font-size":"20px",cursor:"pointer"}},null,8,["onClick"]),Object(a["l"])(K,{onClick:Object(a["V"])((c=>t.updateTour(e)),["stop"]),class:"q-mr-sm",name:null!==e&&void 0!==e&&e.canceled?"check_circle":"cancel",color:"orange",style:{"font-size":"20px",cursor:"pointer"}},{default:Object(a["T"])((()=>[Object(a["l"])(N,{class:"bg-orange",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:Object(a["T"])((()=>[Object(a["l"])("div",{class:"tw-text-sm",textContent:Object(a["O"])(e.canceled?"Activate Tour":"Cancel Tour")},null,8,["textContent"])])),_:2},1024)])),_:2},1032,["onClick","name"]),Object(a["l"])(K,{onClick:Object(a["V"])((c=>t.remove(e)),["stop"]),name:"delete",color:"negative",style:{"font-size":"20px",cursor:"pointer"}},null,8,["onClick"])])])])),_:2},1032,["style"]),Object(a["l"])(N,null,{default:Object(a["T"])((()=>[Object(a["l"])("div",f,Object(a["O"])(e.name),1),e.startDate?(Object(a["C"])(),Object(a["h"])("div",m,[w,Object(a["l"])("span",v,Object(a["O"])(t.$helper.formatDate(e.startDate)),1)])):Object(a["i"])("",!0),e.endDate?(Object(a["C"])(),Object(a["h"])("div",h,[y,Object(a["l"])("span",g,Object(a["O"])(t.$helper.formatDate(e.endDate)),1)])):Object(a["i"])("",!0),e.guide?(Object(a["C"])(),Object(a["h"])("div",T,[x,Object(a["l"])("span",k,Object(a["O"])(e.guide.name),1)])):Object(a["i"])("",!0)])),_:2},1024)])))),128))])])])])),_:2},1024)])),_:2},1024),Object(a["l"])($,{spaced:"",inset:""})])))),128)),Object.keys(t.tours).length||t.loadingList?Object(a["i"])("",!0):(Object(a["C"])(),Object(a["h"])("div",C,[Y]))])),_:1})])),_:1}),t.id?(Object(a["C"])(),Object(a["h"])(U,{id:t.id,key:t.refreshView,onEdit:t.edit,onRemove:t.remove,onUpdateNotification:t.updateNotification,onUpdateTour:t.updateTour},null,8,["id","onEdit","onRemove","onUpdateNotification","onUpdateTour"])):Object(a["i"])("",!0)],64)}var M=c("971e"),L=c("6c02"),S=c("1840"),q=c("f32a"),Q=c("7b9e"),E=c("b3fe"),K=c("5a0c"),N=c.n(K),_=c("f906"),V=c.n(_),I=c("56ff"),$=c("6a2b"),H=c("3203"),z=c("8bd8"),U=c("28b0"),P=c("9530"),R=c.n(P),B=c("3f1c"),J=c("3a18"),A=c("ddd6"),F=c("5c8a"),G=function(t,e,c,a){function o(t){return t instanceof c?t:new c((function(e){e(t)}))}return new(c||(c=Promise))((function(c,l){function i(t){try{s(a.next(t))}catch(e){l(e)}}function n(t){try{s(a["throw"](t))}catch(e){l(e)}}function s(t){t.done?c(t.value):o(t.value).then(i,n)}s((a=a.apply(t,e||[])).next())}))},W=Object(a["m"])({components:{SearchTour:I["default"],ShowLsTour:U["default"],PendingNotificationTour:$["default"]},setup(){N.a.extend(V.a);const t=Object(L["d"])(),e=Object(E["a"])(),{list:c,items:o,search:l,templates:i,getTemplates:n}=Object(M["a"])(),{getTours:s,loading:r}=c(),{getNotificationsTour:d}=Object(z["a"])(),{refetch:b,load:u,onResult:O}=d();if(O((()=>{o.value.length||s()})),o.value.length){const t=J["cache"].readQuery({query:q["listLsTourQuery"],variables:l.value});t&&(o.value=Object(F["a"])(t.listLsTours))}const{setServiceInUse:j,service:p}=Object(H["a"])();Object(a["S"])((()=>p.value.code),(()=>{u()}));const{getService:f,loading:m}=j();f("ls"),Object(a["E"])("service",p);const{getNotifications:w}=Object(A["b"])();w("ls"),Object(a["E"])("search",l),i.value.length||n(),Object(a["E"])("templates",i);const v=Object(a["H"])(""),{mutate:h,onError:y,onDone:g,loading:T}=Object(S["d"])(q["deleteTourMutation"],(()=>({update:(t,{data:{deleteTour:{tour:{id:e}}}})=>{o.value=o.value.filter((t=>t.id!=e)),t.writeQuery({query:q["listLsTourQuery"],variables:Object.assign({},l.value),data:{tours:o.value}})}})));y((t=>{Object(Q["b"])(t)})),g((()=>{Object(Q["c"])({message:"The item have been deleted."})})),Object(a["S"])([r,T],(([t,e])=>B["a"].value=t||e)),Object(a["E"])("getTours",s),Object(a["E"])("loading",r);const{mutate:x,onError:k,onDone:C}=Object(S["d"])(R.a`
        mutation updateNotificationTourMutation(
          $input: updateNotificationTourInput!
        ) {
          updateNotificationTour(input: $input) {
            notificationTour {
              id
              complete
            }
          }
        }
      `);C((()=>{b()})),k((t=>{Object(Q["b"])(t)}));const{mutate:Y,onError:D}=Object(S["d"])(R.a`
          mutation updateLsTourMutation($input: updateTourInput!) {
            updateTour(input: $input) {
              tour {
                id
                canceled
                color
              }
            }
          }
        `);D((t=>{Object(Q["b"])(t)}));const K=Object(a["f"])((()=>{let t=[];return o.value.forEach((e=>{const c=N()(e.startDate).format("MM/DD/YYYY");t[c]||(t[c]=[]),t[c].push(e)})),t}));return{id:Object(a["H"])(null),refreshView:Object(a["H"])(!1),service:p,tours:K,loadingList:r,loadingService:m,edit(e){t.push({name:"EditLsTour",params:{id:e}})},remove(t){T.value||e.dialog({title:"Confirm",message:"Would you like to delete this item?",cancel:!0,persistent:!0}).onOk((()=>{v.value=t.startDate,h({input:{id:t.id}})}))},dateColumn(t){return`<div>${N()(t).format("dddd")}</div><div>${N()(t).format("DD/MM/YYYY")}</div>`},showing:Object(a["f"])((()=>{let t="",e="";return t=l.value.from?N()(l.value.from).format("DD/MM/YYYY"):N()().format("DD/MM/YYYY"),e=l.value.to?N()(l.value.to).format("DD/MM/YYYY"):N()(l.value.from||new Date).add(p.value.daysToShow||0,"day").format("DD/MM/YYYY"),`<span class="tw-text-gray-700">Showing </span> ${N()(e,"DD/MM/YYYY").diff(N()(t,"DD/MM/YYYY"),"day")}<span class="tw-text-gray-700"> days. From</span> `+t+' <span class="tw-text-gray-700">to</span> '+e})),updateNotification(t){return G(this,void 0,void 0,(function*(){yield x({input:{id:t.id,complete:!t.complete}}),t.complete=!t.complete,J["cache"].writeQuery({query:q["listLsTourQuery"],variables:Object.assign({},l.value),data:{listTours:o.value}})}))},updateTour(t){Y({input:{id:t.id,canceled:!t.canceled}})}}}}),X=c("9989"),Z=c("f09f"),tt=c("1c1c"),et=c("66e5"),ct=c("4074"),at=c("b047"),ot=c("0016"),lt=c("05c0"),it=c("eb85"),nt=c("eebe"),st=c.n(nt);W.render=D;e["default"]=W;st()(W,"components",{QPage:X["a"],QCard:Z["a"],QList:tt["a"],QItem:et["a"],QItemSection:ct["a"],QChip:at["a"],QIcon:ot["a"],QTooltip:lt["a"],QSeparator:it["a"]})}}]);